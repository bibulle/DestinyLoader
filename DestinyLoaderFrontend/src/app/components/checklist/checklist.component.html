<div class="page" *ngIf="checklist">
  <div class="character character{{i}}" *ngFor="let character of checklist.characters; let i = index"
       [style.flex]="'1 1 '+(100/checklist.characters.length)+'%'">
    <mat-card class="character-card-sticky character-card-sticky{{i}}">
      <div>
        <mat-card-title
            [style.background-image]="'url(https://www.bungie.net'+character.emblemBackgroundPath+')'">
          <div class="type">{{character.genderedClassNames}}<span
              class="race">{{character.genderedRaceNames}}</span><span class="light">{{character.light}}</span>
          </div>

        </mat-card-title>
      </div>
      <div class="tooltip" *ngIf="(i === checklist.characters.length - 1) && !config.showOnlyPowerfulGear"
           (click)="toggleShowOnlyPowerfulGear()">{{'power_gear_not_only'|translate}}
      </div>
      <div class="tooltip" *ngIf="(i === checklist.characters.length - 1) &&  config.showOnlyPowerfulGear"
           (click)="toggleShowOnlyPowerfulGear()">{{'power_gear_only'|translate}}
      </div>
    </mat-card>
    <mat-card class="character-card character-card{{i}}">
      <div>
        <mat-card-title
            [style.background-image]="'url(https://www.bungie.net'+character.emblemBackgroundPath+')'">
          <div class="type">{{character.genderedClassNames}}<span
              class="race">{{character.genderedRaceNames}}</span><span class="light">{{character.light}}</span>
          </div>

        </mat-card-title>
      </div>
      <div class="tooltip" *ngIf="(i === checklist.characters.length - 1) && !config.showOnlyPowerfulGear"
           (click)="toggleShowOnlyPowerfulGear()">{{'power_gear_not_only'|translate}}
      </div>
      <div class="tooltip" *ngIf="(i === checklist.characters.length - 1) &&  config.showOnlyPowerfulGear"
           (click)="toggleShowOnlyPowerfulGear()">{{'power_gear_only'|translate}}
      </div>
    </mat-card>
    <div *ngFor="let pursuit of character.pursuits">
      <mat-card class="pursuit-item" *ngIf="pursuitShouldBeDisplayed(pursuit)" title="{{pursuit.description}}">
        <mat-card-title class="pursuit-title">
          <img class="pursuit-item-icon" *ngIf="pursuit.icon" src="https://www.bungie.net{{pursuit.icon}}"
               alt="{{pursuit.itemTypeDisplayName}}" title="{{pursuit.itemTypeDisplayName}}">
          <div class="pursuit-text">
            <span class="pursuit-itemType" *ngIf="!pursuit.icon">{{pursuit.itemTypeDisplayName}} : </span>
            {{pursuit.name}}
            <div class="pursuit-description">{{pursuit.description}}</div>
            <div class="pursuit-expiration"
                 *ngIf="pursuit.expirationDate">{{pursuit.expirationDate | timeExpiration }}</div>
            <div class="pursuit-expiration"
                 *ngIf="pursuit.itemTypeDisplayName == 'Vendor'">{{'available_bounty' | translate }}
              : {{pursuit.vendorName}}</div>
          </div>
        </mat-card-title>
        <mat-card-subtitle class="reward" *ngFor="let reward of pursuit.rewards">
          <div *ngIf="reward && !reward.redeemed && ((reward.earned !== false) || (pursuit.objectives.length != 0))">
            <img class="reward-icon" *ngIf="reward.icon" src="https://www.bungie.net{{reward.icon}}"
                 alt="{{reward.name}}">
            <span *ngIf="reward.identifier && (reward.identifier != pursuit.name)">
            <img class="reward-identifier-icon" *ngIf="reward.identifierIcon"
                 src="https://www.bungie.net{{reward.identifierIcon}}" title="{{reward.identifier}}"
                 alt="{{reward.identifier}}">
          </span>
            <span>{{reward.name}} {{reward.quantity < 2 ? '' : '+' + reward.quantity}}</span>
          </div>
        </mat-card-subtitle>
        <div *ngIf="pursuit.objectives">
          <mat-card-subtitle class="objective" *ngFor="let objective of pursuit.objectives"
                             title="{{objective.objectiveHash}}">
            <mat-checkbox class="objective-checkbox"
                          [ngClass]="{'objective-checkbox-border': (objective.completionValue >= 1)}" readonly
                          [ngModel]="objective.complete">
              <div class="objective-progressbar" [style.width]="(100*objective.progress/objective.completionValue)+'%'">
                &nbsp;
              </div>
              <span class="objective-description">{{objective.item.progressDescription}}
                <span *ngIf="objective.timeTillFinished > 0">({{objective.timeTillFinished | timeExpiration}})</span>
            </span>
              <span class="objective-progress">{{objective.progress}}/{{objective.completionValue}}</span>
            </mat-checkbox>
              <div class="objective-running"
                   *ngIf="(pursuit.itemTypeDisplayName != 'Vendor') && (objective.runningTimeObjective && !objective.runningTimeObjective.finished)"
                   (click)="stopObjectiveTime(objective, character.characterId, pursuit.itemInstanceId)">
                <mat-icon>stop</mat-icon>
                <span>{{objective.runningTimeObjective.timeRunning | timeExpiration}}</span>
              </div>
              <div class="objective-running"
                   *ngIf="(pursuit.itemTypeDisplayName != 'Vendor') && (!objective.runningTimeObjective || objective.runningTimeObjective.finished)"
                   (click)="launchObjectiveTime(objective, character.characterId, pursuit.itemInstanceId)">
                <mat-icon>play_arrow</mat-icon>
              </div>
              <div class="objective-running" *ngIf="pursuit.itemTypeDisplayName == 'Vendor'">
              </div>
          </mat-card-subtitle>
        </div>
      </mat-card>
    </div>
  </div>

</div>
